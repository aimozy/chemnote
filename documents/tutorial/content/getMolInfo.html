<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Get Molecule Information &mdash; Kekule Tutorial 2023.01 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Molecule Comparison and Searching" href="molCompareAndSearch.html" />
    <link rel="prev" title="Loading and Saving Molecule" href="molIO.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Kekule Tutorial
          </a>
              <div class="version">
                2023.01
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="objSys.html">Object and Class System of Kekule.js</a></li>
<li class="toctree-l1"><a class="reference internal" href="atomAndBond.html">Atom and Bond</a></li>
<li class="toctree-l1"><a class="reference internal" href="molCreation.html">Creating Molecule</a></li>
<li class="toctree-l1"><a class="reference internal" href="molIO.html">Loading and Saving Molecule</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Get Molecule Information</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#iterating-over-atoms-and-bonds">Iterating over Atoms and Bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="#molecule-formula">Molecule Formula</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ring-information">Ring Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aromatic-detection">Aromatic Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stereo-perception">Stereo Perception</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="molCompareAndSearch.html">Molecule Comparison and Searching</a></li>
<li class="toctree-l1"><a class="reference internal" href="renderMol.html">Drawing Molecule</a></li>
<li class="toctree-l1"><a class="reference internal" href="widgetIntro.html">Introduction to Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemViewer.html">Chem Viewer Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="composer.html">Composer Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectra.html">Spectra in Kekule.js</a></li>
<li class="toctree-l1"><a class="reference internal" href="webComponent.html">Web Component Wrapper of Widgets</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Kekule Tutorial</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Get Molecule Information</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="get-molecule-information">
<h1>Get Molecule Information<a class="headerlink" href="#get-molecule-information" title="Permalink to this heading"></a></h1>
<p>With the instance of molecule, user can use a series of properties and methods
provided by the toolkit to reveal the information of molecule, from the intuitive
atom/bond count to more complicated feature such as ring set and stereo center.</p>
<section id="iterating-over-atoms-and-bonds">
<h2>Iterating over Atoms and Bonds<a class="headerlink" href="#iterating-over-atoms-and-bonds" title="Permalink to this heading"></a></h2>
<p>Once you have a molecule, it’s easy to loop over its atoms and bonds:<a class="footnote-reference brackets" href="#example" id="id1">1</a></p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// iterate all nodes(atoms)</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">getNodeCount</span><span class="p">();</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">l</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">getNodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;node &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">node</span><span class="p">.</span><span class="nx">getClassName</span><span class="p">(),</span><span class="w"> </span><span class="nx">node</span><span class="p">.</span><span class="nx">getLabel</span><span class="p">());</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="c1">// iterate all connectors(bonds)</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">getConnectorCount</span><span class="p">();</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">l</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">connector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">getConnectorAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;connector &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nx">connector</span><span class="p">.</span><span class="nx">getClassName</span><span class="p">(),</span><span class="w"> </span><span class="nx">connector</span><span class="p">.</span><span class="nx">getBondOrder</span><span class="o">?</span><span class="w"> </span><span class="nx">connector</span><span class="p">.</span><span class="nx">getBondOrder</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;?&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>The atom or bond inside a molecule can also be accessed by its id:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">atom1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">getNodeById</span><span class="p">(</span><span class="s1">&#39;atom1&#39;</span><span class="p">);</span><span class="w">  </span><span class="c1">// returns the atom with id &#39;atom1&#39;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">bond1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">getConnectorById</span><span class="p">(</span><span class="s1">&#39;bond1&#39;</span><span class="p">);</span><span class="w">  </span><span class="c1">// returns the bond with id &#39;bond1&#39;</span><span class="w"></span>
</pre></div>
</div>
<p>To individual node(atom) or connector(bond), their belonged molecule (or structure fragment)
can be get by method <em>getParentFragment</em>:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">mol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">atom</span><span class="p">.</span><span class="nx">getParentFragment</span><span class="p">();</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">mol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bond</span><span class="p">.</span><span class="nx">getParentFragment</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>In the molecule, atoms and bonds connected with each other, their relations can be gained
by properties <em>linkedConnectors</em>, <em>linkedObjs</em> of node and <em>connectedObjs</em> of connector:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">bondsAroundAtom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">atom</span><span class="p">.</span><span class="nx">getLinkedConnectors</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="c1">// returns an array of connectors linked with this atom</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">neighborAtoms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">atom</span><span class="p">.</span><span class="nx">getLinkedObjs</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="c1">// returns neighbor atoms linked with this atom by only one bond</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">objectsLinkedByOneBond</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bond</span><span class="p">.</span><span class="nx">getConnectedObjs</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="c1">// returns array of objects connected by connector</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="molecule-formula">
<h2>Molecule Formula<a class="headerlink" href="#molecule-formula" title="Permalink to this heading"></a></h2>
<p>Formula can be calculated from atoms in molecule:<a class="footnote-reference brackets" href="#example" id="id2">1</a></p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// get molecule in editor</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">mol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getCurrMol</span><span class="p">();</span><span class="w"></span>
<span class="c1">// get the formula object</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">formula</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">calcFormula</span><span class="p">();</span><span class="w"></span>
<span class="c1">// turn formula object into text</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">formula</span><span class="p">.</span><span class="nx">getText</span><span class="p">());</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="ring-information">
<h2>Ring Information<a class="headerlink" href="#ring-information" title="Permalink to this heading"></a></h2>
<p>Kekule.js provides method to easily find all rings and SSSR(Smallest Set of Smallest Rings) of a molecule.
The following codes can be used to get all rings:<a class="footnote-reference brackets" href="#example" id="id3">1</a></p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">mol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getCurrMol</span><span class="p">();</span><span class="w"></span>
<span class="c1">// find all rings of molecule</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">rings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">findAllRings</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>The result of method <em>mol.findAllRings</em> is a JavaScript array, each <em>item</em> of it is an object represents
a ring in the molecule, all nodes(atoms) and connectors(bonds) in the ring can be access by <em>item.nodes</em>
and <em>item.connectors</em>:<a class="footnote-reference brackets" href="#example" id="id4">1</a></p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">ringCountMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span><span class="w"></span>
<span class="c1">// iterate over those rings</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rings</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">l</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">ring</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rings</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">nodeCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ring</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="nx">ringCountMap</span><span class="p">[</span><span class="nx">nodeCount</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">ringCountMap</span><span class="p">[</span><span class="nx">nodeCount</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="c1">// report</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Find &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">rings</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; rings&#39;</span><span class="p">);</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ringCountMap</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">l</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ringCountMap</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">count</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;ring with &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; atoms: &#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">count</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>For example, the codes above to find all rings in phenanthrene will shows the following logs
in the console panel of web browser:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Find 6 rings
ring with 6 atoms:  3
ring with 10 atoms:  2
ring with 14 atoms:  1
</pre></div>
</div>
<p>The SSSR rings can be found with method <em>findSSSR</em>:<a class="footnote-reference brackets" href="#example" id="id5">1</a></p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">mol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getCurrMol</span><span class="p">();</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">mol</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// find SSSR of molecule</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">rings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">findSSSR</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">ringCountMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span><span class="w"></span>
<span class="w">  </span><span class="c1">// iterate over those rings</span><span class="w"></span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rings</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">l</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">ring</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rings</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">nodeCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ring</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nx">ringCountMap</span><span class="p">[</span><span class="nx">nodeCount</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">ringCountMap</span><span class="p">[</span><span class="nx">nodeCount</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="c1">// report</span><span class="w"></span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Find &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">rings</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; SSSR rings&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ringCountMap</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">l</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ringCountMap</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">count</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;ring with &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; atoms: &#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">count</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>The codes above performed on phenanthrene will shows the following logs in console panel:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Find 3 SSSR rings
ring with 6 atoms:  3
</pre></div>
</div>
<p>As ring searching is often to be a time consuming job to complex molecules, ring information returned
by <em>findAllRings</em> and <em>findSSSR</em> will be cached until the structure of molecule been changed.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Currently, multicenter bonds and bond-bond connections are ignored during ring perception.</p>
</div>
</section>
<section id="aromatic-detection">
<h2>Aromatic Detection<a class="headerlink" href="#aromatic-detection" title="Permalink to this heading"></a></h2>
<p>Currently, to save the calculation time, aromatic detection is carried on SSSR rings of molecule in
Kekule.js. You can simply call method <em>findAromaticRings</em>:<a class="footnote-reference brackets" href="#example" id="id6">1</a></p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">mol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getCurrMol</span><span class="p">();</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">mol</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// find aromatic of molecule</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">rings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">findAromaticRings</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">ringCountMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span><span class="w"></span>
<span class="w">  </span><span class="c1">// iterate over those rings</span><span class="w"></span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rings</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">l</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">ring</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rings</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">nodeCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ring</span><span class="p">.</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nx">ringCountMap</span><span class="p">[</span><span class="nx">nodeCount</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">ringCountMap</span><span class="p">[</span><span class="nx">nodeCount</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="c1">// report</span><span class="w"></span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Find &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">rings</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; aromatic rings&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ringCountMap</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">l</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ringCountMap</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">count</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;ring with &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; atoms: &#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">count</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>The codes above performed on phenanthrene will shows the following logs in console panel:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Find 3 aromatic rings
ring with 6 atoms:  3
</pre></div>
</div>
</section>
<section id="stereo-perception">
<h2>Stereo Perception<a class="headerlink" href="#stereo-perception" title="Permalink to this heading"></a></h2>
<p>Chiral atoms or stereo bonds can also be revealed:<a class="footnote-reference brackets" href="#example" id="id7">1</a></p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="nx">chiralNodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">perceiveChiralNodes</span><span class="p">();</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">stereoBonds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mol</span><span class="p">.</span><span class="nx">perceiveStereoConnectors</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>Those methods returns all stereo atoms and bonds. To simplify the calculation,
configuration of atom or bond is not marked with R/S or E/Z but with a parity
value: 1(odd), 2(even) or 0(unknown):<a class="footnote-reference brackets" href="#example" id="id8">1</a></p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">chiralNodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">l</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">chiralNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Chiral center: &#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">getLabel</span><span class="p">(),</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">getParity</span><span class="p">());</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stereoBonds</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">l</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="nx">i</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">stereoBonds</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Stereo bond: &#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">getParity</span><span class="p">());</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<dl class="footnote brackets">
<dt class="label" id="example"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>,<a href="#id3">3</a>,<a href="#id4">4</a>,<a href="#id5">5</a>,<a href="#id6">6</a>,<a href="#id7">7</a>,<a href="#id8">8</a>)</span></dt>
<dd><p>Example of this chapter can be found and run at <a class="reference external" href="../examples/getMolInfo.html">here</a>.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="molIO.html" class="btn btn-neutral float-left" title="Loading and Saving Molecule" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="molCompareAndSearch.html" class="btn btn-neutral float-right" title="Molecule Comparison and Searching" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Partridge Jiang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>